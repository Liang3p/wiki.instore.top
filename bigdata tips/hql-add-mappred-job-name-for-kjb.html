<!DOCTYPE HTML>
<html>
  <head>
    <link rel="Stylesheet" type="text/css" href="/static/css/style.css">
    <link rel="Stylesheet" type="text/css" href="/static/css/tango.css">
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
    <link rel="icon" href="/favicon.ico" type="image/x-icon">
    <link rel="alternate" type="application/atom+xml" href="atom.xml" title="Atom feed">
    <title>hql add mappred job name for kjb - Wiki | instore.top</title>
    <meta name="keywords" content="bigdata hadoop hive spark"/>
    <meta name="description" content="wiki page"/>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  </head>

  <body>
    <div id="container">
      
<div id="header">
  <div class="post-nav"><a href="/">Home</a>&nbsp;&#187;&nbsp;<a href="/#bigdata tips">bigdata tips</a>&nbsp;&#187;&nbsp;hql add mappred job name for kjb
    <span class="updated">Page Updated&nbsp;
      2018-03-09 17:28
    </span></div>
</div>
<div class="clearfix"></div>

<div class="page_title">hql add mappred job name for kjb</div>

  <p>修改kettle作业文件(job*.kjb),sql节点首行增加mapred.job.name设置<br />
Set mapred.job.name=${Internal.Job.Name}:TO_DW;</p>
<ul>
<li>目的<br />
<img alt="" src="./target.png" /></li>
</ul>
<p>sed脚本修改方法:</p>
<div class="hlcode"><pre><span class="c"># 查找当前目录下所有kjb文件,在&lt;sql&gt;标签内首行增加设置</span>
find . -name <span class="s2">&quot;job*.kjb&quot;</span> | xargs sed -i <span class="s2">&quot;s/&lt;sql&gt;\(.*\)&lt;\/sql&gt;/&lt;sql&gt;set mapred.job.name\&amp;#x3d;\&amp;#x24;\&amp;#x7b;Internal.Job.Name\&amp;#x7d;\&amp;#x3a;TO_DW\&amp;#x3b;\&amp;#xd;\&amp;#xa;\1&lt;\/sql&gt;/g&quot;</span>

<span class="c"># 查找已修改的内容</span>
find . -name <span class="s2">&quot;job*.kjb&quot;</span> | xargs grep --color<span class="o">=</span>auto -C3 <span class="s1">&#39;set mapred.job.name\&amp;#x3d;\&amp;#x24;\&amp;#x7b;Internal.Job.Name\&amp;#x7d;\&amp;#x3a;TO_DW\&amp;#x3b;\&amp;#xd;\&amp;#xa;&#39;</span>
</pre></div>


<ul>
<li>
<p>sed替换<br />
<img alt="" src="./log01.png" /></p>
</li>
<li>
<p>查找已修改的内容<br />
<img alt="" src="./log02.png" /></p>
</li>
<li>
<p>验证kjb文件<br />
<img alt="" src="./kjb.png" /></p>
</li>
</ul>
    </div>
    <div id="footer">
      <span>
        <p>Copyright © 2018 instore.top.
        Powered by <a href="http://simiki.org/" target="_blank">Simiki</a>.</p>
        <p>Site Generated 2018-03-09 19:56:35</p>
      </span>
    </div>

    
    
  </body>
</html>